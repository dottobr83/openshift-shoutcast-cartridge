openshift-SHOUTcast-cartridge
=============================

SHOUTcast Distribution for Openshift Cloud Apps

Concept
-------

Streaming service with (not yet functional) scaling capabilities, simple one line installation:

Currently available distributions:
----------------------------------

--------------------------------------------------------------------------------------------
> __rhc__ app-create __app-name__ http://shoutscale-rightoradio.rhcloud.com/manifest/master
--------------------------------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------
> __rhc__ app-create __app-name__ https://github.com/theunknownartisthour/openshift-shoutcast-cartridge
--------------------------------------------------------------------------------------------------------

Approach to scaling:
--------------------

Each gear or node hosts a distribution of SHOUTcast each with a modifiable configuration.
The first gear or node hosts SHOUTcast and acts as the primary relay point for other nodes.
The configuration is generated by environment variables which will always properly connect
SHOUTcast.

Relaying:
---------
(TODO!)
```

RelayPort=80
RelayServer=IP/URL 
```
Primary Node:
-------------

```
portbase=${OPENSHIFT_SCS_PORT}
destip=${OPENSHIFT_SCS_IP}
publicip=${OPENSHIFT_APP_DNS}
```

The gears are address based on the least amount of connections as determined by the standard
haproxy which can be added by using the --scaling option to the command lines above.
SHOUTcast is then up and running listening to the destip:portbase which is externally addressable.
The publicip option lets SHOUTcast know the proper address to use for .pls .m3u ect... when the server is marked public.

Current issues: 
---------------

* Creating a url endpoint to the first node which bypasses haproxy.
* Changing haproxy's configuration to avoid initial conflict between haproxy's health check at the backend /

The issue is that this get requests the stream before there's a stream available, SHOUTcast responds with an http error
haproxy then closes outside connections from reaching the backend. Although not a problem if you just want to port forward into the app

------------------------------------
> __rhc__ port-forward __app-name__
------------------------------------

Thank You's:
------------

Credit to this guy, who inspired to to make a diy:
http://blog.piratelufi.com/2013/11/use-openshift-as-a-free-shoutcast-server/

Then whoever put together this, because now I have a little understanding of what I'm doing:
http://openshift.github.io/documentation/oo_cartridge_developers_guide.html

Plus a thank you to the over-contributor DrO for debugging some SHOUTcast configs:
http://forums.winamp.com
